(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{28:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),s=n(18),i=n.n(s),o=(n(28),n(22)),r=n(2),u=n(3),l=n.p+"static/media/mesto-logo.03b78ada.svg",d=n(8),p=n(19),h=n(20),j=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(p.a)(this,e),this._baseUrl=n,this._headers=a}return Object(h.a)(e,[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject(e.status)}},{key:"loadUserInfo",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{credentials:"include",headers:this._headers}).then(this._checkResponse)}},{key:"getCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{credentials:"include",headers:this._headers}).then(this._checkResponse)}},{key:"updateUserInfo",value:function(e){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",credentials:"include",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._checkResponse)}},{key:"addCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",credentials:"include",headers:this._headers,body:JSON.stringify({name:e.newPlaceName,link:e.newPlaceLink})}).then(this._checkResponse)}},{key:"handleDeleteCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",credentials:"include",headers:this._headers}).then(this._checkResponse)}},{key:"setLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e,"/likes"),{method:"PUT",credentials:"include",headers:this._headers}).then(this._checkResponse)}},{key:"unsetLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e,"/likes"),{method:"DELETE",credentials:"include",headers:this._headers}).then(this._checkResponse)}},{key:"changeLikeStatus",value:function(e,t){return t?this.unsetLike(e):this.setLike(e)}},{key:"changeAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",credentials:"include",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}},{key:"logout",value:function(){return fetch("".concat(this._baseUrl,"/logout"),{method:"GET",credentials:"include"})}}]),e}())({baseUrl:"https://backend-mesto-domain.nomoredomains.club",headers:{"Content-Type":"application/json"}}),b=n(0);var m=Object(u.g)((function(e){var t=c.a.useState(),n=Object(r.a)(t,2),a=n[0],s=n[1],i=c.a.useState(""),o=Object(r.a)(i,2),u=o[0],p=o[1],h=c.a.useState(),m=Object(r.a)(h,2),f=m[0],_=m[1],O={display:"inline-block",textDecoration:"none",marginTop:"auto",marginRight:"0",marginBottom:"auto",marginLeft:"24px",fontSize:"18px",lineHeight:"22px",textAlign:"right",color:"#A9A9A9"};return c.a.useEffect((function(){!function(){var t=e.location.pathname;"/sign-up"===t?(s("\u0412\u043e\u0439\u0442\u0438"),p("/sign-in"),_("")):"/sign-in"===t?(s("\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"),p("/sign-up"),_("")):"/"===t&&(s("\u0412\u044b\u0439\u0442\u0438"),p("/sign-up"),_(e.userEmail))}()}),[e.location.pathname,e.userEmail]),Object(b.jsxs)("header",{className:"header",children:[Object(b.jsx)("img",{className:"header__logo",src:l,alt:"\u041c\u0435\u0441\u0442\u043e"}),Object(b.jsx)("span",{className:"header__email",children:f}),"/"===e.location.pathname?Object(b.jsx)(d.b,{to:u,style:O,onClick:function(){j.logout(),e.handleSignOut(!1)},children:a}):Object(b.jsx)(d.b,{to:u,style:O,children:a})]})})),f=c.a.createContext();var _=function(e){var t=c.a.useContext(f),n=t._id===e.card.owner,a=e.card.likes.some((function(e){return e===t._id})),s="card__like-button ".concat(a?"card__like-button_active":""),i="card__delete-button ".concat(n?"":"card__delete-button_hidden");return Object(b.jsxs)("article",{className:"card",children:[Object(b.jsx)("img",{className:"card__image",src:e.card.link,alt:e.card.name,onClick:function(){e.onCardClick(e.card)}}),Object(b.jsxs)("div",{className:"card__title",children:[Object(b.jsx)("h2",{className:"card__text",children:e.card.name}),Object(b.jsx)("button",{className:s,type:"button",onClick:function(){e.onCardLike(e.card)}}),Object(b.jsx)("p",{className:"card__quantity-of-likes",children:e.card.likes.length})]}),Object(b.jsx)("button",{className:i,type:"button",onClick:function(){e.onCardDelete(e.card)}})]})};var O=function(){return Object(b.jsx)("footer",{children:Object(b.jsx)("p",{className:"footer",children:"\xa9 2021 Mesto Russia"})})};var x=function(e){var t=c.a.useContext(f),n=e.cards.map((function(t){return Object(b.jsx)(_,{card:t,onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete},t._id)}));return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("main",{className:"content",children:[Object(b.jsxs)("section",{className:"profile",children:[Object(b.jsx)("div",{className:"profile__avatar",style:{backgroundImage:"url(".concat(t.avatar,")")},children:Object(b.jsx)("div",{className:"profile__new-avatar-button",onClick:e.onEditAvatar})}),Object(b.jsxs)("div",{className:"profile__info",children:[Object(b.jsx)("h1",{className:"profile__name",children:t.name}),Object(b.jsx)("button",{className:"profile__edit-button",type:"button",onClick:e.onEditProfile}),Object(b.jsx)("h2",{className:"profile__about",children:t.about})]}),Object(b.jsx)("button",{className:"profile__add-button",type:"button",onClick:e.onAddPlace})]}),Object(b.jsx)("section",{className:"cards",children:n})]}),Object(b.jsx)(O,{})]})};var g=function(e){return Object(b.jsx)("div",{className:"pop-up pop-up_type_".concat(e.name," ").concat(e.isOpen?"pop-up_opened":""),children:Object(b.jsxs)("div",{className:"pop-up__container",children:[Object(b.jsx)("p",{className:"pop-up__title",children:e.title}),Object(b.jsxs)("form",{className:"pop-up__form",name:e.name,onSubmit:e.onSubmit,children:[e.children,Object(b.jsx)("button",{className:"pop-up__submit-button",type:"submit",children:e.buttonContent})]}),Object(b.jsx)("button",{className:"pop-up__close-button",type:"button",onClick:e.onClose})]})})};var v=function(e){var t=c.a.useState(""),n=Object(r.a)(t,2),a=n[0],s=n[1],i=c.a.useState(""),o=Object(r.a)(i,2),u=o[0],l=o[1],d=c.a.useContext(f);return c.a.useEffect((function(){s(d.name),l(d.about)}),[d,e.isOpen]),Object(b.jsxs)(g,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"edit",buttonContent:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:a,about:u})},children:[Object(b.jsxs)("fieldset",{className:"pop-up__fieldset",children:[Object(b.jsx)("input",{className:"pop-up__input",value:a||"",onChange:function(e){s(e.target.value)},type:"text",id:"profile-name",name:"profileName",placeholder:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f",minLength:"2",maxLength:"40",required:!0}),Object(b.jsx)("span",{className:"pop-up__input-error",id:"error",children:"\u0422\u0435\u043a\u0441\u0442 \u043e\u0448\u0438\u0431\u043a\u0438"})]}),Object(b.jsxs)("fieldset",{className:"pop-up__fieldset",children:[Object(b.jsx)("input",{className:"pop-up__input",value:u||"",onChange:function(e){l(e.target.value)},type:"text",id:"profile-about",name:"profileAbout",placeholder:"\u0420\u0430\u0441\u0441\u043a\u0430\u0436\u0438\u0442\u0435 \u043e \u0441\u0435\u0431\u0435",minLength:"2",maxLength:"200",required:!0}),Object(b.jsx)("span",{className:"pop-up__input-error profile-about-error-message",children:"\u0422\u0435\u043a\u0441\u0442 \u043e\u0448\u0438\u0431\u043a\u0438"})]})]})};var C=function(e){var t=c.a.useRef();return c.a.useEffect((function(){t.current.value=""}),[e.isOpen]),Object(b.jsx)(g,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"change-avatar",buttonContent:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar(t.current.value)},children:Object(b.jsxs)("fieldset",{className:"pop-up__fieldset",children:[Object(b.jsx)("input",{className:"pop-up__input",ref:t,defaultValue:"",id:"new-avatar",name:"newAvatar",placeholder:"\u0412\u0432\u0435\u0434\u0434\u0438\u0442\u0435 \u0441\u0441\u044b\u043b\u043a\u0443",type:"url",required:!0}),Object(b.jsx)("span",{className:"pop-up__input-error new-place-link-error-message",children:"\u0422\u0435\u043a\u0441\u0442 \u043e\u0448\u0438\u0431\u043a\u0438"})]})})};var N=function(e){var t=c.a.useState(),n=Object(r.a)(t,2),a=n[0],s=n[1],i=c.a.useState(),o=Object(r.a)(i,2),u=o[0],l=o[1];return c.a.useEffect((function(){s(""),l("")}),[e.isOpen]),Object(b.jsxs)(g,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"new-card",buttonContent:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onAddCard({newPlaceName:a,newPlaceLink:u})},children:[Object(b.jsxs)("fieldset",{className:"pop-up__fieldset",children:[Object(b.jsx)("input",{className:"pop-up__input",value:a||"",onChange:function(e){s(e.target.value)},type:"text",id:"new-place-name",name:"newPlaceName",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",minLength:"2",maxLength:"30",required:!0}),Object(b.jsx)("span",{className:"pop-up__input-error new-place-name-error-message",children:"\u0422\u0435\u043a\u0441\u0442 \u043e\u0448\u0438\u0431\u043a\u0438"})]}),Object(b.jsxs)("fieldset",{className:"pop-up__fieldset",children:[Object(b.jsx)("input",{className:"pop-up__input",value:u||"",onChange:function(e){l(e.target.value)},type:"url",id:"new-place-link",name:"newPlaceLink",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0}),Object(b.jsx)("span",{className:"pop-up__input-error new-place-link-error-message",children:"\u0422\u0435\u043a\u0441\u0442 \u043e\u0448\u0438\u0431\u043a\u0438"})]})]})};var k=function(e){return Object(b.jsx)("div",{className:"pop-up pop-up_type_preview ".concat(void 0!==e.card.name?"pop-up_opened":""),children:Object(b.jsxs)("div",{className:"pop-up__container pop-up__container_preview",children:[Object(b.jsx)("img",{className:"pop-up__photo",src:e.card.link,alt:e.card.name}),Object(b.jsx)("p",{className:"pop-up__description",children:e.card.name}),Object(b.jsx)("button",{className:"pop-up__close-button",type:"button",onClick:e.onClose})]})})};var y=function(e){var t=c.a.useState(""),n=Object(r.a)(t,2),a=n[0],s=n[1],i=c.a.useState(""),o=Object(r.a)(i,2),u=o[0],l=o[1];return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("div",{className:"auth",children:[Object(b.jsx)("h1",{className:"auth__title",children:"\u0412\u0445\u043e\u0434"}),Object(b.jsxs)("form",{className:"auth__form",onSubmit:function(t){t.preventDefault(),e.handleSubmit(a,u)},children:[Object(b.jsx)("input",{className:"auth__input",placeholder:"Email",type:"email",value:a,onChange:function(e){s(e.target.value)}}),Object(b.jsx)("input",{className:"auth__input",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",type:"password",value:u,onChange:function(e){l(e.target.value)}}),Object(b.jsx)("input",{className:"auth__submit-button",type:"submit",value:"\u0412\u043e\u0439\u0442\u0438"})]})]}),e.children]})};var S=function(e){var t=c.a.useState(""),n=Object(r.a)(t,2),a=n[0],s=n[1],i=c.a.useState(""),o=Object(r.a)(i,2),u=o[0],l=o[1];return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("div",{className:"auth",children:[Object(b.jsx)("h1",{className:"auth__title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(b.jsxs)("form",{className:"auth__form",onSubmit:function(t){t.preventDefault(),e.handleSubmit(a,u)},children:[Object(b.jsx)("input",{className:"auth__input",placeholder:"Email",type:"email",value:a,onChange:function(e){s(e.target.value)}}),Object(b.jsx)("input",{className:"auth__input",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",type:"password",value:u,onChange:function(e){l(e.target.value)}}),Object(b.jsx)("input",{className:"auth__submit-button",type:"submit",value:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})]}),Object(b.jsxs)("span",{className:"auth__already-reg",children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b? ",Object(b.jsx)(d.b,{to:"/sign-in",children:"\u0412\u043e\u0439\u0442\u0438"})]})]}),e.children]})},w="https://backend-mesto-domain.nomoredomains.club";function L(e){return e.ok?e.json():Promise.reject(e.status)}var E=n.p+"static/media/OK.1b6082f8.svg",U=n.p+"static/media/Error.df8eddf6.svg";var P=function(e){var t=e.status;return Object(b.jsx)("div",{className:"pop-up ".concat(e.isOpen?"pop-up_opened":""),children:Object(b.jsxs)("div",{className:"pop-up__container",children:[Object(b.jsx)("img",{className:"pop-up__status-logo",src:t?E:U,alt:"status-logo"}),Object(b.jsx)("p",{className:"pop-up__message",children:t?"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!":"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437."}),Object(b.jsx)("button",{className:"pop-up__close-button",type:"button",onClick:e.onClose})]})})},A=n(23),D=function(e){var t=Object.assign({},e);return Object(b.jsx)(u.a,{children:function(){return t.loggedIn&&Object(b.jsx)(x,Object(A.a)({},t))}})};var T=function(){var e=c.a.useState(!1),t=Object(r.a)(e,2),n=t[0],a=t[1],s=c.a.useState(!1),i=Object(r.a)(s,2),l=i[0],d=i[1],p=c.a.useState(!1),h=Object(r.a)(p,2),_=h[0],O=h[1],E=c.a.useState(!1),U=Object(r.a)(E,2),A=U[0],T=U[1],R=c.a.useState(!1),I=Object(r.a)(R,2),F=I[0],J=I[1],q=c.a.useState(!1),B=Object(r.a)(q,2),H=B[0],M=B[1],z=c.a.useState({}),G=Object(r.a)(z,2),K=G[0],V=G[1],Q=c.a.useState(""),W=Object(r.a)(Q,2),X=W[0],Y=W[1],Z=c.a.useState(),$=Object(r.a)(Z,2),ee=$[0],te=$[1],ne=c.a.useState({}),ae=Object(r.a)(ne,2),ce=ae[0],se=ae[1],ie=c.a.useState([]),oe=Object(r.a)(ie,2),re=oe[0],ue=oe[1],le=c.a.useState({}),de=Object(r.a)(le,2),pe=de[0],he=de[1],je=Object(u.f)();c.a.useEffect((function(){j.loadUserInfo().then((function(e){V(e),Y(e.email),j.getCards().then((function(e){return ue(e)})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u0438 \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443 "+e)})),te(!0)})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u0438 \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443 "+e),je.push("/sign-up")}))}),[ee]);var be=function(){a(!1),O(!1),d(!1),T(!1),J(!1),se({})};return Object(b.jsxs)(f.Provider,{value:K,children:[Object(b.jsx)(m,{userEmail:X,handleSignOut:te}),Object(b.jsxs)(u.c,{children:[Object(b.jsx)(u.a,{path:"/sign-up",children:Object(b.jsx)(S,{handleSubmit:function(e,t){(function(e,t){return fetch("".concat(w,"/signup"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return L(e)}))})(e,t).then((function(){J(!0),M(!0),je.push("/sign-in")})).catch((function(e){J(!0),M(!1),console.log("\u0412\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 "+e)}))}})}),Object(b.jsx)(u.a,{path:"/sign-in",children:Object(b.jsx)(y,{handleSubmit:function(e,t){(function(e,t){return fetch("".concat(w,"/signin"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return L(e)}))})(e,t).then((function(e){localStorage.setItem("jwt",e.token),te(!0),je.push("/")})).catch((function(e){console.log("\u0412\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 "+e)}))}})}),Object(b.jsx)(u.a,{exact:!0,path:"/",children:Object(b.jsx)(D,{path:"/",loggedIn:ee,component:x,onEditProfile:function(){a(!0)},onAddPlace:function(){O(!0)},onEditAvatar:function(){d(!0)},onCardClick:function(e){se(e)},onCardLike:function(e){var t=e.likes.some((function(e){return e===K._id}));j.changeLikeStatus(e._id,t).then((function(t){ue(re.map((function(n){return n._id===e._id?t:n})))})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u0438 \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443 "+e)}))},onCardDelete:function(e){he(e),T(!0)},cards:re})})]}),Object(b.jsx)(v,{isOpen:n,onClose:be,onUpdateUser:function(e){j.updateUserInfo(e).then((function(e){V(e),be()})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u0438 \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443 "+e)}))}}),Object(b.jsx)(C,{isOpen:l,onClose:be,onUpdateAvatar:function(e){j.changeAvatar(e).then((function(e){V(e),be()})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u0438 \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443 "+e)}))}}),Object(b.jsx)(N,{isOpen:_,onClose:be,onAddCard:function(e){j.addCard(e).then((function(e){ue([e].concat(Object(o.a)(re))),be()})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u0438 \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443 "+e)}))}}),Object(b.jsx)(g,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"confirm",buttonContent:"\u0414\u0430",isOpen:A,onSubmit:function(e){e.preventDefault(),j.handleDeleteCard(pe._id).then((function(){ue(re.filter((function(e){return e._id!==pe._id}))),he({}),be()})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u0438 \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443 "+e)}))},onClose:be}),Object(b.jsx)(k,{card:ce,onClose:be}),Object(b.jsx)(P,{isOpen:F,status:H,onClose:be})]})},R=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,36)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),s(e),i(e)}))};i.a.render(Object(b.jsx)(c.a.StrictMode,{children:Object(b.jsx)(d.a,{children:Object(b.jsx)(T,{})})}),document.getElementById("root")),R()}},[[35,1,2]]]);
//# sourceMappingURL=main.babfc65b.chunk.js.map